<title>Lens Blur</title>

<style>
html,
body {
  height: 100%;
}
body {
  overflow: hidden;
  margin: 0;
  background-color: #000;
}
canvas {
  position: absolute;
  top: 0;
  left: 50%;
  transform: translate(-50%, 0);
}
</style>

<script src="http://evanw.github.io/glfx.js/glfx.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.3/dat.gui.min.js"></script>

<script>
const data = {
  radius: 10,
  brightness: 0.75,
  angle: 0,
  triangleBlur: 50
};

window.onload = function () {
  // try to create a WebGL canvas (will fail if WebGL isn't supported)
  try {
    var canvas = fx.canvas();
  } catch (e) {
    alert(e);
    return;
  }

  // convert the image to a texture
  var image = document.getElementById('image');
  var texture = canvas.texture(image);

  // apply the ink filter
  update()

  // replace the image with the canvas
  image.parentNode.insertBefore(canvas, image);
  image.parentNode.removeChild(image);

  var gui = new dat.GUI();
  gui.add(data, 'radius', 0, 100).onChange(update);
  gui.add(data, 'brightness', -1, 1).onChange(update);
  gui.add(data, 'angle', -Math.PI, Math.PI).onChange(update);
  gui.add(data, 'triangleBlur', 0, 200).onChange(update);

  function update () {
    canvas.draw(texture).lensBlur(data.radius, data.brightness, data.angle).triangleBlur(data.triangleBlur).update();
  }
};
</script>

<body>
<img id="image" src="image/star.jpeg" style="width: 100%; height: 100%; object-fit: cover;">
</body>
